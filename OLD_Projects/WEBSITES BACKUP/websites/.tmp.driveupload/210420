(()=>{var e={};e.id=694,e.ids=[694],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},41649:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>o,routeModule:()=>x,tree:()=>d});var r=t(67096),i=t(16132),a=t(37284),l=t.n(a),n=t(32564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["courses",{children:["import-courses",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,84762)),"/Users/ron/websites/mana-running/src/app/courses/import-courses/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,79113)),"/Users/ron/websites/mana-running/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/Users/ron/websites/mana-running/src/app/courses/import-courses/page.tsx"],m="/courses/import-courses/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/courses/import-courses/page",pathname:"/courses/import-courses",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},93323:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,53579,23)),Promise.resolve().then(t.t.bind(t,30619,23)),Promise.resolve().then(t.t.bind(t,81459,23)),Promise.resolve().then(t.t.bind(t,13456,23)),Promise.resolve().then(t.t.bind(t,50847,23)),Promise.resolve().then(t.t.bind(t,57303,23))},43375:(e,s,t)=>{Promise.resolve().then(t.bind(t,36604))},96739:()=>{},36604:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var r=t(53854),i=t(34218),a=t(29184),l=t(39787),n=t.n(l);function c(){let[e,s]=(0,i.useState)({step:"upload",csvData:[],previewData:[]}),t=async()=>{s(e=>({...e,step:"importing"}));let t=0,r=0,i=[];for(let s=0;s<e.csvData.length;s++){let l=e.csvData[s];try{let e=l.distance_meters/1609.344,n=e>=1?`${e.toFixed(2)} mi`:`${(5280*e).toFixed(0)} ft`,c=`${l.Venue.trim()} | ${l.distance_meters}m (${n})`,d=4747/l.distance_meters*(1.17688/l.mile_difficulty),o=Math.round(1e3*d)/1e3,{data:m}=await a.OQ.from("courses").select("id, name").ilike("name",`${l.Venue.trim()}%`).gte("distance_meters",l.distance_meters-50).lte("distance_meters",l.distance_meters+50);if(m&&m.length>0){let{error:e}=await a.OQ.from("courses").update({name:c,distance_meters:l.distance_meters,mile_difficulty:l.mile_difficulty,xc_time_rating:o,rating_confidence:"estimated"}).eq("id",m[0].id);e?i.push(`${l.Venue}: Update failed - ${e.message}`):r++}else{let{error:e}=await a.OQ.from("courses").insert({name:c,distance_meters:l.distance_meters,mile_difficulty:l.mile_difficulty,xc_time_rating:o,rating_confidence:"estimated"});e?i.push(`${l.Venue}: Create failed - ${e.message}`):t++}s%20==0&&await new Promise(e=>setTimeout(e,100))}catch(e){i.push(`${l.Venue}: ${e instanceof Error?e.message:"Unknown error"}`)}}s(e=>({...e,step:"complete",importResult:{created:t,updated:r,errors:i}}))},l=()=>{s({step:"upload",csvData:[],previewData:[]})},{isValid:c,issues:d}="preview"===e.step?(()=>{let s=[];if(0===e.csvData.length)return s.push("No data found in CSV file"),{isValid:!1,issues:s};let t=e.csvData[0];t.Venue||s.push('Missing "Venue" column'),t.distance_meters||s.push('Missing "distance_meters" column'),t.mile_difficulty||s.push('Missing "mile_difficulty" column');let r=e.previewData.filter(e=>e.distance_meters<800||e.distance_meters>1e4);r.length>0&&s.push(`${r.length} courses have unusual distances (outside 800-10000m)`);let i=e.previewData.filter(e=>e.mile_difficulty<.8||e.mile_difficulty>3);return i.length>0&&s.push(`${i.length} courses have unusual difficulty ratings (outside 0.8-3.0)`),{isValid:0===s.length,issues:s}})():{isValid:!0,issues:[]};return r.jsx("div",{className:"container mx-auto p-6",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Import Courses from CSV"}),r.jsx("p",{className:"text-gray-600",children:"Upload your AllCourses.csv file to import all venues with correct XC ratings"})]}),e.error&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:e.error}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:["upload"===e.step&&r.jsx("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"csv-file",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV File"}),r.jsx("input",{id:"csv-file",type:"file",accept:".csv",onChange:e=>{let t=e.target.files?.[0];t&&(s(e=>({...e,error:void 0})),n().parse(t,{header:!0,skipEmptyLines:!0,dynamicTyping:!0,complete:e=>{try{let t=e.data.filter(e=>e.Venue&&e.distance_meters>0&&e.mile_difficulty>0);if(0===t.length){s(e=>({...e,error:"No valid courses found in CSV. Check column names and data format."}));return}let r=t.slice(0,10);s(e=>({...e,step:"preview",csvData:t,previewData:r}))}catch(e){s(s=>({...s,error:e instanceof Error?e.message:"Failed to process CSV"}))}},error:e=>{s(s=>({...s,error:`CSV parsing error: ${e.message}`}))}}))},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-green-50 file:text-green-700 hover:file:bg-green-100"})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"Expected CSV Format:"}),(0,r.jsxs)("div",{className:"text-sm text-blue-800 space-y-2",children:[r.jsx("p",{children:r.jsx("strong",{children:"Required columns:"})}),(0,r.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,r.jsxs)("li",{children:[r.jsx("code",{children:"Venue"})," - Course venue name"]}),(0,r.jsxs)("li",{children:[r.jsx("code",{children:"distance_meters"})," - Distance in meters"]}),(0,r.jsxs)("li",{children:[r.jsx("code",{children:"mile_difficulty"})," - Difficulty vs 1-mile track"]})]}),r.jsx("p",{className:"mt-3",children:r.jsx("strong",{children:"Example:"})}),(0,r.jsxs)("code",{className:"block bg-white p-2 rounded text-xs",children:["Venue,distance_meters,mile_difficulty",r.jsx("br",{}),"Crystal Springs,4747,1.17688",r.jsx("br",{}),"Alum Rock Park,3701,1.13235"]})]})]})]})}),"preview"===e.step&&(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Preview Import Data"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Found ",e.csvData.length," courses. Showing first 10 rows."]})]}),r.jsx("div",{className:`px-3 py-1 rounded text-sm font-medium ${c?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c?"Valid":"Issues Found"})]}),!c&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:[r.jsx("p",{className:"font-medium mb-2",children:"Data validation issues:"}),r.jsx("ul",{className:"list-disc list-inside text-sm",children:d.map((e,s)=>r.jsx("li",{children:e},s))})]}),r.jsx("div",{className:"overflow-x-auto mb-6",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b bg-gray-50",children:[r.jsx("th",{className:"text-left p-3",children:"Venue"}),r.jsx("th",{className:"text-left p-3",children:"Distance (m)"}),r.jsx("th",{className:"text-left p-3",children:"Distance (mi)"}),r.jsx("th",{className:"text-left p-3",children:"Difficulty"}),r.jsx("th",{className:"text-left p-3",children:"Calculated XC Rating"}),r.jsx("th",{className:"text-left p-3",children:"Generated Name"})]})}),r.jsx("tbody",{children:e.previewData.map((e,s)=>{let t=e.distance_meters/1609.344,i=t>=1?`${t.toFixed(2)} mi`:`${(5280*t).toFixed(0)} ft`,a=`${e.Venue.trim()} | ${e.distance_meters}m (${i})`,l=4747/e.distance_meters*(1.17688/e.mile_difficulty);return(0,r.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[r.jsx("td",{className:"p-3",children:e.Venue}),r.jsx("td",{className:"p-3",children:e.distance_meters}),r.jsx("td",{className:"p-3",children:t.toFixed(2)}),r.jsx("td",{className:"p-3",children:e.mile_difficulty}),r.jsx("td",{className:"p-3",children:l.toFixed(3)}),r.jsx("td",{className:"p-3 text-xs",children:a})]},s)})})]})}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("button",{onClick:t,disabled:!c,className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:["Import ",e.csvData.length," Courses"]}),r.jsx("button",{onClick:l,className:"bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700",children:"Choose Different File"})]})]}),"importing"===e.step&&(0,r.jsxs)("div",{className:"p-6 text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-4"}),r.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Importing Courses..."}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Processing ",e.csvData.length," courses. This may take a few minutes."]})]}),"complete"===e.step&&e.importResult&&(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[r.jsx("div",{className:"text-4xl mb-2",children:"✓"}),r.jsx("h2",{className:"text-2xl font-semibold text-green-600",children:"Import Complete!"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"text-center bg-green-50 p-4 rounded",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.importResult.created}),r.jsx("div",{className:"text-sm text-green-800",children:"Created"})]}),(0,r.jsxs)("div",{className:"text-center bg-blue-50 p-4 rounded",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.importResult.updated}),r.jsx("div",{className:"text-sm text-blue-800",children:"Updated"})]}),(0,r.jsxs)("div",{className:"text-center bg-red-50 p-4 rounded",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.importResult.errors.length}),r.jsx("div",{className:"text-sm text-red-800",children:"Errors"})]})]}),e.importResult.errors.length>0&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 p-4 rounded mb-6",children:[r.jsx("h3",{className:"font-medium text-red-800 mb-2",children:"Import Errors:"}),r.jsx("div",{className:"max-h-32 overflow-y-auto",children:r.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:e.importResult.errors.map((e,s)=>(0,r.jsxs)("li",{children:["• ",e]},s))})})]}),(0,r.jsxs)("div",{className:"text-center space-x-3",children:[r.jsx("a",{href:"/courses",className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"View All Courses"}),r.jsx("button",{onClick:l,className:"bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700",children:"Import Another File"})]})]})]})]})})}},29184:(e,s,t)=>{"use strict";t.d(s,{OQ:()=>i});var r=t(97955);let i=(0,r.eI)("https://nxhsgmujfjdncrconerr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54aHNnbXVqZmpkbmNyY29uZXJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzMDE2ODEsImV4cCI6MjA3Mzg3NzY4MX0.ZnKjJfe3Fv4Jv-dY-P0-ZnatFpW6DEI7nRUDtQ9wu4o")},84762:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>a,default:()=>c});var r=t(95153);let i=(0,r.createProxy)(String.raw`/Users/ron/websites/mana-running/src/app/courses/import-courses/page.tsx`),{__esModule:a,$$typeof:l}=i,n=i.default,c=n},79113:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n,metadata:()=>l});var r=t(4656),i=t(37910),a=t.n(i);t(5023);let l={title:"Mana Running - Cross Country Statistics",description:"Comprehensive Cross Country Statistics & Performance Analytics"};function n({children:e}){return r.jsx("html",{lang:"en",children:(0,r.jsxs)("body",{className:`${a().variable} antialiased font-inter`,children:[r.jsx("header",{className:"bg-black text-white p-6",children:r.jsx("div",{className:"container mx-auto",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-4xl font-bold mb-2",children:r.jsx("a",{href:"/",className:"hover:text-gray-300",children:"Mana Running"})}),r.jsx("p",{className:"text-gray-200",children:"Comprehensive Cross Country Statistics & Performance Analytics"})]}),(0,r.jsxs)("nav",{className:"flex space-x-4",children:[r.jsx("a",{href:"/",className:"px-4 py-2 bg-gray-700 rounded hover:bg-gray-600 transition-colors",children:"Home"}),r.jsx("a",{href:"/meets",className:"px-4 py-2 bg-blue-600 rounded hover:bg-blue-500 transition-colors",children:"Meets"}),r.jsx("a",{href:"/courses",className:"px-4 py-2 bg-green-600 rounded hover:bg-green-500 transition-colors",children:"Courses"}),r.jsx("a",{href:"/schools",className:"px-4 py-2 bg-red-600 rounded hover:bg-red-500 transition-colors",children:"Schools"}),r.jsx("a",{href:"/athletes",className:"px-4 py-2 bg-orange-600 rounded hover:bg-orange-500 transition-colors",children:"Athletes"}),r.jsx("a",{href:"/admin",className:"px-4 py-2 bg-yellow-600 rounded hover:bg-yellow-500 transition-colors",children:"Admin"})]})]})})}),e]})})}},73881:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(31323);let i=e=>{let s=(0,r.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:s+""}]}},5023:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[494,50,323,817,787],()=>t(41649));module.exports=r})();