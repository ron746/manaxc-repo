(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{487:function(e,t,s){Promise.resolve().then(s.bind(s,5804))},5804:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}});var a=s(7437),r=s(2265),l=s(6702);function n(){let[e,t]=(0,r.useState)({schools:0,athletes:0,courses:0,meets:0,results:0}),[s,n]=(0,r.useState)(!0),[i,o]=(0,r.useState)("overview"),[d,c]=(0,r.useState)([]),[m,u]=(0,r.useState)([]),[h,g]=(0,r.useState)(""),[x,f]=(0,r.useState)({first_name:"",last_name:"",graduation_year:"",gender:""}),[y,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{w()},[]);let w=async()=>{try{n(!0);let[e,s,a,r,i]=await Promise.all([l.kI.getAll(),l.jZ.getAll(),l.kd.getAll(),l.Bj.getAll(),l.Ab.getTotalCount()]);t({schools:(null==e?void 0:e.length)||0,athletes:(null==s?void 0:s.length)||0,courses:(null==a?void 0:a.length)||0,meets:(null==r?void 0:r.length)||0,results:i||0}),c(r||[]),u(s||[])}catch(e){console.error("Error loading admin data:",e)}finally{n(!1)}},v=async()=>{if(!h){alert("Please select an athlete to edit");return}try{b(!0),await l.jZ.update(h,{first_name:x.first_name||void 0,last_name:x.last_name||void 0,graduation_year:x.graduation_year?parseInt(x.graduation_year):void 0,gender:x.gender||void 0}),alert("Athlete updated successfully"),g(""),f({first_name:"",last_name:"",graduation_year:"",gender:""}),await w()}catch(e){console.error("Error updating athlete:",e),alert("Error updating athlete: "+(e instanceof Error?e.message:String(e)))}finally{b(!1)}},p=e=>{let t=m.find(t=>t.id===e);if(t){var s;f({first_name:t.first_name||"",last_name:t.last_name||"",graduation_year:(null===(s=t.graduation_year)||void 0===s?void 0:s.toString())||"",gender:t.gender||""})}};return((0,r.useEffect)(()=>{h&&p(h)},[h]),s)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xl font-semibold mb-2",children:"Loading Admin Dashboard..."}),(0,a.jsx)("div",{className:"text-gray-600",children:"Getting system data..."})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-black mb-2",children:"Admin Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage your cross country database with bulk operations and editing tools"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,a.jsx)("div",{className:"border-b",children:(0,a.jsx)("nav",{className:"flex space-x-8 px-6",children:(0,a.jsx)("button",{onClick:()=>o("overview"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("overview"===i?"border-yellow-500 text-yellow-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"System Overview"})})}),(0,a.jsxs)("div",{className:"p-6",children:["overview"===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-black mb-6",children:"Database Overview"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"text-center p-6 bg-white border border-gray-200 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-black",children:e.schools}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Schools"})]}),(0,a.jsxs)("div",{className:"text-center p-6 bg-red-50 border border-red-200 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-red-600",children:e.athletes}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Athletes"})]}),(0,a.jsxs)("div",{className:"text-center p-6 bg-green-50 border border-green-200 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-green-600",children:e.courses}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Courses"})]}),(0,a.jsxs)("div",{className:"text-center p-6 bg-blue-50 border border-blue-200 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:e.meets}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Meets"})]}),(0,a.jsxs)("div",{className:"text-center p-6 bg-yellow-50 border border-yellow-200 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-yellow-600",children:e.results}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Results"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-bold text-black mb-2",children:"Data Import"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Import race results and athlete data from CSV files"}),(0,a.jsx)("a",{href:"/import",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Import Data"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-bold text-black mb-2",children:"Search Tools"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Advanced search and filtering across all data"}),(0,a.jsx)("a",{href:"/search",className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700",children:"Advanced Search"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-bold text-black mb-2",children:"System Health"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Check data integrity and system performance"}),(0,a.jsx)("button",{className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",disabled:!0,children:"Coming Soon"})]})]})]}),"bulk-edit"===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-black mb-6",children:"Bulk Edit Operations"}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h4",{className:"font-bold text-black mb-4",children:"Edit Athlete Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Athlete to Edit"}),(0,a.jsxs)("select",{value:h,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-yellow-500 focus:border-yellow-500",children:[(0,a.jsx)("option",{value:"",children:"Choose an athlete..."}),m.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name," (",e.graduation_year,")"]},e.id))]})]}),h&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),(0,a.jsx)("input",{type:"text",value:x.first_name,onChange:e=>f({...x,first_name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-yellow-500 focus:border-yellow-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),(0,a.jsx)("input",{type:"text",value:x.last_name,onChange:e=>f({...x,last_name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-yellow-500 focus:border-yellow-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Graduation Year"}),(0,a.jsx)("input",{type:"number",value:x.graduation_year,onChange:e=>f({...x,graduation_year:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-yellow-500 focus:border-yellow-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),(0,a.jsxs)("select",{value:x.gender,onChange:e=>f({...x,gender:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-yellow-500 focus:border-yellow-500",children:[(0,a.jsx)("option",{value:"",children:"Select gender..."}),(0,a.jsx)("option",{value:"M",children:"Male"}),(0,a.jsx)("option",{value:"F",children:"Female"}),(0,a.jsx)("option",{value:"Boys",children:"Boys"}),(0,a.jsx)("option",{value:"Girls",children:"Girls"})]})]}),(0,a.jsx)("button",{onClick:v,disabled:y,className:"w-full bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 disabled:opacity-50",children:y?"Updating...":"Update Athlete"})]})]})]})})]})]})]}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)("a",{href:"/",className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition-colors",children:"â† Back to Dashboard"})})]})})}},6702:function(e,t,s){"use strict";s.d(t,{Ab:function(){return o},Bj:function(){return n},jZ:function(){return r},kI:function(){return l},kd:function(){return i}});var a=s(7823);let r={async getAll(){let{data:e,error:t}=await a.OQ.from("athletes").select("\n        *,\n        school:schools(id, name)\n      ").order("last_name");if(t)throw t;return e},async getById(e){let{data:t,error:s}=await a.OQ.from("athletes").select("\n        *,\n        school:schools(*)\n      ").eq("id",e).single();if(s)throw s;return t},async getTotalCount(){let{count:e,error:t}=await a.OQ.from("athletes").select("*",{count:"exact",head:!0});if(t)throw t;return e},async create(e){let{data:t,error:s}=await a.OQ.from("athletes").insert(e).select("\n        *,\n        school:schools(name)\n      ").single();if(s)throw s;return t},async update(e,t){let{data:s,error:r}=await a.OQ.from("athletes").update(t).eq("id",e).select("\n        *,\n        school:schools(name)\n      ").single();if(r)throw r;return s}},l={async getAll(){let{data:e,error:t}=await a.OQ.from("schools").select("*").order("name");if(t)throw t;return e}},n={async getAll(){let{data:e,error:t}=await a.OQ.from("meets").select("\n        *,\n        races(\n          id,\n          name,\n          category,\n          gender,\n          total_participants,\n          course:courses(name)\n        )\n      ").order("meet_date",{ascending:!1});if(t)throw t;return e},async getById(e){let{data:t,error:s}=await a.OQ.from("meets").select("\n        *,\n        course:courses(*),\n        results(\n          *,\n          athlete:athletes(\n            *,\n            school:schools(name)\n          )\n        )\n      ").eq("id",e).single();if(s)throw s;return t},async create(e){let t={name:e.name,meet_date:e.date,course_id:e.course_id,meet_type:e.meet_type,weather_conditions:e.weather_conditions},{data:s,error:r}=await a.OQ.from("meets").insert(t).select("\n      *,\n      course:courses(name)\n    ").single();if(r)throw r;return s},async update(e,t){let{data:s,error:r}=await a.OQ.from("meets").update(t).eq("id",e).select("\n        *,\n        course:courses(name)\n      ").single();if(r)throw r;return s},async delete(e){let{data:t}=await a.OQ.from("results").select("id").eq("meet_id",e);t&&t.length>0&&await a.OQ.from("results").delete().eq("meet_id",e);let{error:s}=await a.OQ.from("meets").delete().eq("id",e);if(s)throw s;return{deletedResultsCount:(null==t?void 0:t.length)||0}}},i={async getAll(){let{data:e,error:t}=await a.OQ.from("courses").select("\n        id,\n        created_at,\n        name,\n        distance_meters,\n        distance_miles,\n        mile_difficulty,\n        xc_time_rating,\n        rating_confidence,\n        rating_last_updated,\n        total_results_count,\n        meets(count)\n      ").order("name");if(t)throw t;return null==e?void 0:e.map(e=>{var t;return{...e,meets_count:(null===(t=e.meets[0])||void 0===t?void 0:t.count)||0}})},async getById(e){let{data:t,error:s}=await a.OQ.from("courses").select("\n        *,\n        meets(*)\n      ").eq("id",e).single();if(s)throw s;return t},async create(e){let{data:t,error:s}=await a.OQ.from("meets").insert({name:e.name,meet_date:e.date,course_id:e.course_id,meet_type:e.meet_type}).select().single();if(s)throw s;return t},async update(e,t){let{data:s,error:r}=await a.OQ.from("courses").update(t).eq("id",e).select().single();if(r)throw r;return s},async delete(e){let{data:t}=await a.OQ.from("meets").select("id").eq("course_id",e);if(t&&t.length>0)throw Error("Cannot delete course. ".concat(t.length," meets use this course. Delete meets first."));let{error:s}=await a.OQ.from("courses").delete().eq("id",e);if(s)throw s;return!0}},o={async getAll(){let{data:e,error:t}=await a.OQ.from("results").select("\n        *,\n        athlete:athletes(first_name, last_name, graduation_year, school:schools(name)),\n        meet:meets(name, meet_date, course:courses(name))\n      ").order("meet_id",{ascending:!1});if(t)throw t;return e},async getAllWithDetails(){let{data:e,error:t}=await a.OQ.from("results_with_details").select("*").order("meet_date",{ascending:!1});if(t)throw t;return e},async getByMeetId(e){let{data:t,error:s}=await a.OQ.from("results").select("\n        *,\n        athlete:athletes(id, first_name, last_name, graduation_year, school:schools(name))\n      ").eq("meet_id",e).order("place_overall");if(s)throw s;return t},async create(e){let{data:t,error:s}=await a.OQ.from("results").insert(e).select("\n        *,\n        athlete:athletes(first_name, last_name, school:schools(name)),\n        meet:meets(name, meet_date)\n      ").single();if(s)throw s;return t},async update(e,t){let{data:s,error:r}=await a.OQ.from("results").update(t).eq("id",e).select("\n        *,\n        athlete:athletes(first_name, last_name, school:schools(name)),\n        meet:meets(name, meet_date)\n      ").single();if(r)throw r;return s},async delete(e){let{error:t}=await a.OQ.from("results").delete().eq("id",e);if(t)throw t;return!0},async deleteMultiple(e){let{error:t}=await a.OQ.from("results").delete().in("id",e);if(t)throw t;return!0},async searchAllResults(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,s=a.OQ.from("results_with_details").select("*").order("meet_date",{ascending:!1});e&&(s=s.or("first_name.ilike.%".concat(e,"%,last_name.ilike.%").concat(e,"%,school_name.ilike.%").concat(e,"%,meet_name.ilike.%").concat(e,"%")));let{data:r,error:l}=await s.limit(t);if(l)throw l;return r},async getAllWithPagination(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,s=(e-1)*t,{data:r,error:l}=await a.OQ.from("results_with_details").select("*").order("meet_date",{ascending:!1}).range(s,s+t-1);if(l)throw l;return r},async getTotalCount(){let{count:e,error:t}=await a.OQ.from("results_with_details").select("*",{count:"exact",head:!0});if(t)throw t;return e}}},7823:function(e,t,s){"use strict";s.d(t,{OQ:function(){return r}});var a=s(7440);let r=(0,a.eI)("https://nxhsgmujfjdncrconerr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54aHNnbXVqZmpkbmNyY29uZXJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzMDE2ODEsImV4cCI6MjA3Mzg3NzY4MX0.ZnKjJfe3Fv4Jv-dY-P0-ZnatFpW6DEI7nRUDtQ9wu4o")}},function(e){e.O(0,[872,971,472,744],function(){return e(e.s=487)}),_N_E=e.O()}]);