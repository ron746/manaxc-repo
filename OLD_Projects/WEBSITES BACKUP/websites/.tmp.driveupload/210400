(()=>{var e={};e.id=806,e.ids=[806],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},63605:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>d});var r=s(67096),a=s(16132),i=s(37284),n=s.n(i),l=s(32564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["admin",{children:["mass-import",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,18199)),"/Users/ron/websites/mana-running/src/app/admin/mass-import/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,79113)),"/Users/ron/websites/mana-running/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/ron/websites/mana-running/src/app/admin/mass-import/page.tsx"],m="/admin/mass-import/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/mass-import/page",pathname:"/admin/mass-import",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},93323:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,53579,23)),Promise.resolve().then(s.t.bind(s,30619,23)),Promise.resolve().then(s.t.bind(s,81459,23)),Promise.resolve().then(s.t.bind(s,13456,23)),Promise.resolve().then(s.t.bind(s,50847,23)),Promise.resolve().then(s.t.bind(s,57303,23))},40245:(e,t,s)=>{Promise.resolve().then(s.bind(s,42958))},96739:()=>{},42958:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(53854),a=s(34218),i=s(29184),n=s(39787),l=s.n(n);async function o(e,t,s){let{data:r}=await i.OQ.from("courses").select("id").eq("name",e).eq("distance_meters",t).single();if(r)return r.id;let{data:a}=await i.OQ.from("courses").select("id, name, distance_meters");if(a)for(let s of a){let r=s.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(s.name.toLowerCase()),a=50>=Math.abs(s.distance_meters-t);if(r&&a)return console.log(`Fuzzy matched: ${e} (${t}m) â†’ ${s.name} (${s.distance_meters}m)`),s.id}let n=621371e-9*t,l=4747/t*1.17688,{data:o,error:d}=await i.OQ.from("courses").insert({name:`${e} | ${t}m (${n.toFixed(2)} mi)`,distance_meters:t,mile_difficulty:1,xc_time_rating:l,rating_confidence:"estimated"}).select("id").single();if(d)throw d;return s.coursesCreated++,o.id}async function d(e,t){let{data:s}=await i.OQ.from("schools").select("id").eq("name",e).single();if(s)return s.id;let{data:r,error:a}=await i.OQ.from("schools").insert({name:e}).select("id").single();if(a)throw a;return t.schoolsCreated++,r.id}async function c(e,t,s,r,a,n){let{data:l}=await i.OQ.from("athletes").select("id").eq("first_name",e).eq("last_name",t).eq("graduation_year",s).single();if(l)return l.id;let{data:o,error:d}=await i.OQ.from("athletes").insert({first_name:e,last_name:t,graduation_year:s,gender:r,current_school_id:a}).select("id").single();if(d)throw d;return n.athletesCreated++,o.id}async function m(e,t,s,r){let{data:a}=await i.OQ.from("meets").select("id").eq("name",e).eq("meet_date",t).single();if(a)return a.id;let{data:n,error:l}=await i.OQ.from("meets").insert({name:e,meet_date:t,meet_type:s}).select("id").single();if(l)throw l;return r.meetsCreated++,n.id}async function x(e,t,s,r,a){let{data:n}=await i.OQ.from("races").select("id").eq("meet_id",e).eq("category",t).eq("gender",s).single();if(n)return n.id;let l=`${t} ${"M"===s?"Boys":"Girls"}`,{data:o,error:d}=await i.OQ.from("races").insert({meet_id:e,name:l,category:t,gender:s,course_id:r}).select("id").single();if(d)throw d;return a.racesCreated++,o.id}async function h(e){let t={totalRows:0,coursesCreated:0,schoolsCreated:0,athletesCreated:0,meetsCreated:0,racesCreated:0,resultsCreated:0,errors:[]};try{let s=await e.text(),r=l().parse(s,{header:!0,skipEmptyLines:!0,dynamicTyping:!0});t.totalRows=r.data.length;for(let e=0;e<r.data.length;e++){let s=r.data[e];try{let r=function(e){let t=e.split("/");if(3!==t.length)throw Error(`Invalid date format: ${e}`);let[s,r,a]=t.map(e=>parseInt(e));return a<100&&(a=a>=60?1900+a:2e3+a),`${a}-${String(s).padStart(2,"0")}-${String(r).padStart(2,"0")}`}(s.meet_date),a=function(e){let t=e.split(":");if(2!==t.length)throw Error(`Invalid time format: ${e}`);let s=parseInt(t[0]),r=parseFloat(t[1]);return Math.round((60*s+r)*100)}(s.time),n="UNK"===s.race_category?"Varsity":s.race_category,l=await o(s.course_name,s.distance_meters,t),h=await d(s.school_name,t),u=await c(s.athlete_first_name,s.athlete_last_name,s.graduation_year,s.gender,h,t),g=await m(s.meet_name,r,s.meet_type,t),p=await x(g,n,s.gender,l,t),{error:f}=await i.OQ.from("results").insert({athlete_id:u,meet_id:g,race_id:p,time_seconds:a,place_overall:s.place,season_year:s.season});if(f)throw f;t.resultsCreated++,(e+1)%100==0&&console.log(`Processed ${e+1} / ${t.totalRows} rows`)}catch(s){t.errors.push(`Row ${e+1}: ${s instanceof Error?s.message:String(s)}`)}}return{success:0===t.errors.length,message:0===t.errors.length?"Import completed successfully":`Import completed with ${t.errors.length} errors`,stats:t}}catch(e){return{success:!1,message:e instanceof Error?e.message:String(e),stats:t}}}function u(){let[e,t]=(0,a.useState)(null),[s,i]=(0,a.useState)(!1),[n,l]=(0,a.useState)(null),o=async()=>{if(e){i(!0),l(null);try{let t=await h(e);l(t)}catch(e){l({success:!1,message:e instanceof Error?e.message:"Import failed",stats:null})}finally{i(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-8",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Mass Results Import"}),r.jsx("p",{className:"text-slate-600 mb-8",children:"Upload CSV file with meet results from multiple meets and courses"}),(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select CSV File"}),r.jsx("input",{type:"file",accept:".csv",onChange:e=>{e.target.files&&e.target.files[0]&&(t(e.target.files[0]),l(null))},disabled:s,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 disabled:opacity-50"}),e&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-slate-600",children:["Selected: ",e.name," (",(e.size/1024).toFixed(1)," KB)"]})]}),r.jsx("button",{onClick:o,disabled:!e||s,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s?"Importing...":"Start Import"}),s&&r.jsx("div",{className:"mt-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[r.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mr-3"}),r.jsx("span",{className:"text-slate-700",children:"Processing rows... Check console for progress"})]})}),n&&(0,r.jsxs)("div",{className:`mt-6 p-6 rounded-lg ${n.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[r.jsx("h2",{className:`text-lg font-bold mb-4 ${n.success?"text-green-800":"text-red-800"}`,children:n.message}),n.stats&&(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-slate-800",children:n.stats.totalRows}),r.jsx("div",{className:"text-sm text-slate-600",children:"Total Rows"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.stats.resultsCreated}),r.jsx("div",{className:"text-sm text-slate-600",children:"Results Created"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.stats.coursesCreated}),r.jsx("div",{className:"text-sm text-slate-600",children:"Courses Created"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.stats.schoolsCreated}),r.jsx("div",{className:"text-sm text-slate-600",children:"Schools Created"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.stats.athletesCreated}),r.jsx("div",{className:"text-sm text-slate-600",children:"Athletes Created"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-pink-600",children:n.stats.meetsCreated}),r.jsx("div",{className:"text-sm text-slate-600",children:"Meets Created"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.stats.racesCreated}),r.jsx("div",{className:"text-sm text-slate-600",children:"Races Created"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.stats.errors.length}),r.jsx("div",{className:"text-sm text-slate-600",children:"Errors"})]})]}),n.stats&&n.stats.errors.length>0&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("h3",{className:"font-semibold text-red-800 mb-2",children:["Errors (",n.stats.errors.length,"):"]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 max-h-60 overflow-y-auto",children:[n.stats.errors.slice(0,50).map((e,t)=>(0,r.jsxs)("div",{className:"text-sm text-red-700 mb-1",children:["â€¢ ",e]},t)),n.stats.errors.length>50&&(0,r.jsxs)("div",{className:"text-sm text-red-600 font-semibold mt-2",children:["... and ",n.stats.errors.length-50," more errors"]})]})]})]}),(0,r.jsxs)("div",{className:"mt-8 p-6 bg-slate-50 rounded-lg border border-slate-200",children:[r.jsx("h3",{className:"font-semibold text-slate-800 mb-3",children:"CSV Format Requirements:"}),(0,r.jsxs)("ul",{className:"text-sm text-slate-600 space-y-2",children:[(0,r.jsxs)("li",{children:["â€¢ ",r.jsx("strong",{children:"meet_date:"})," MM/DD/YY format (handles 1960s-2025)"]}),(0,r.jsxs)("li",{children:["â€¢ ",r.jsx("strong",{children:"time:"})," MM:SS.S format"]}),(0,r.jsxs)("li",{children:["â€¢ ",r.jsx("strong",{children:"gender:"})," M or F"]}),(0,r.jsxs)("li",{children:["â€¢ ",r.jsx("strong",{children:"distance_meters:"})," Integer (e.g., 4747, 5000)"]}),(0,r.jsxs)("li",{children:["â€¢ ",r.jsx("strong",{children:"race_category:"}),' Use "UNK" to default to Varsity']}),r.jsx("li",{children:"â€¢ Intelligent course matching: exact â†’ fuzzy (\xb150m) â†’ create new"}),r.jsx("li",{children:"â€¢ Progress logged to console every 100 rows"})]})]})]})})})}},29184:(e,t,s)=>{"use strict";s.d(t,{OQ:()=>a});var r=s(97955);let a=(0,r.eI)("https://nxhsgmujfjdncrconerr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54aHNnbXVqZmpkbmNyY29uZXJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzMDE2ODEsImV4cCI6MjA3Mzg3NzY4MX0.ZnKjJfe3Fv4Jv-dY-P0-ZnatFpW6DEI7nRUDtQ9wu4o")},18199:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>o});var r=s(95153);let a=(0,r.createProxy)(String.raw`/Users/ron/websites/mana-running/src/app/admin/mass-import/page.tsx`),{__esModule:i,$$typeof:n}=a,l=a.default,o=l},79113:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>n});var r=s(4656),a=s(37910),i=s.n(a);s(5023);let n={title:"Mana Running - Cross Country Statistics",description:"Comprehensive Cross Country Statistics & Performance Analytics"};function l({children:e}){return r.jsx("html",{lang:"en",children:(0,r.jsxs)("body",{className:`${i().variable} antialiased font-inter`,children:[r.jsx("header",{className:"bg-black text-white p-6",children:r.jsx("div",{className:"container mx-auto",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-4xl font-bold mb-2",children:r.jsx("a",{href:"/",className:"hover:text-gray-300",children:"Mana Running"})}),r.jsx("p",{className:"text-gray-200",children:"Comprehensive Cross Country Statistics & Performance Analytics"})]}),(0,r.jsxs)("nav",{className:"flex space-x-4",children:[r.jsx("a",{href:"/",className:"px-4 py-2 bg-gray-700 rounded hover:bg-gray-600 transition-colors",children:"Home"}),r.jsx("a",{href:"/meets",className:"px-4 py-2 bg-blue-600 rounded hover:bg-blue-500 transition-colors",children:"Meets"}),r.jsx("a",{href:"/courses",className:"px-4 py-2 bg-green-600 rounded hover:bg-green-500 transition-colors",children:"Courses"}),r.jsx("a",{href:"/schools",className:"px-4 py-2 bg-red-600 rounded hover:bg-red-500 transition-colors",children:"Schools"}),r.jsx("a",{href:"/athletes",className:"px-4 py-2 bg-orange-600 rounded hover:bg-orange-500 transition-colors",children:"Athletes"}),r.jsx("a",{href:"/admin",className:"px-4 py-2 bg-yellow-600 rounded hover:bg-yellow-500 transition-colors",children:"Admin"})]})]})})}),e]})})}},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(31323);let a=e=>{let t=(0,r.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:t+""}]}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[494,50,323,817,787],()=>s(63605));module.exports=r})();